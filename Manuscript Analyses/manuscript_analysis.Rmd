---
title: Cognitive and Auditory Predictors of Dysarthric Speech Understanding in Older
  Adult Listeners
author: "Lansford, Hirsch, Barrett, & Borrie"
date: "`r Sys.Date()`"
output: 
  github_document:
    code_folding: hide
    toc: true
    toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Purpose

This document contains the analysis code and output for the manuscript entitled "Cognitive and Auditory Predictors of Dysarthric Speech Understanding in Older Adult Listeners". These results will also be presented at the Biannual Motor Speech Conference held in San Diego, CA from February 21-24, 2024.

All data processing and analyses was conducted using R Version 4.3.2


```{r, echo = F, warning = F, message = F}

# Loading in needed packages
library(tidyverse) #install.packages("tidyverse")
library(rio) #install.packages("rio")
library(gt) #install.packages("gt")
library(reshape2) #install.packages("reshape2")
library(ggcorrplot) #install.packages("ggcorrplot")
library(patchwork) #install.packages("patchwork")
library(janitor) #install.packages("janitor")
library(fs) #install.packages("fs")
library(furniture) #install.packages("furniture")
library(caret) #install.packages("caret")
library(effectsize) #install.packages("effectsize")
library(parameters) #install.packages("parameters")
library(performance) #install.packages("performance")
library(bayestestR) #install.packages("bayestestR)
library(rstanarm) #install.packages("rstanarm")

```


```{r, echo = F, warning = F, message = F}

# Functions used in this code

## Function for determining variable importance
var_imp <- function(mod, label) {
  varImp(mod)$importance %>%
    rownames_to_column(var = "Variable") %>%
    mutate(Overall = Overall/max(Overall)) %>%
    rename(!!label := Overall, 
          var = Variable)
}

## Function for model training
training <- function(data, method, int) {
  form = if (isTRUE(int)) {
    d2 = model.matrix(pwc ~ . * ., data = data)[, -1] %>%
      as_tibble() %>%
      janitor::clean_names()
    d2$pwc = data$pwc
  } else {
    d2 = data
    train(
      pwc ~.,
      data = d2,
      preProcess = c("center", "scale"),
      method = "repeatedcv",
      number = 5,
      repeats = 10
    )
  }
}

```

# Descriptives

## Participant Demographics

```{r}

demo <- rio::import("participant_demo.csv")



```

## Cognition

```{r}

cog <- rio::import("cleaned_data.csv") %>%
  dplyr::select(c(id, speaker, list_sort_c:win_l)) %>%
  dplyr::mutate(best_win = ifelse(win_r < win_l, win_r, win_l)) %>%
  dplyr::distinct()

age <- demo %>%
  select(id, age)

cog_scores <- left_join(age, cog, by = "id")

cog_scores %>%
  dplyr::group_by(speaker) %>%
  furniture::table1(age, list_sort_c, flanker_c, card_sort_c, vocab_c, pattern_c, 
                    pic_seq_c, fluid_cog_c, best_win,
                    test = T, 
                    export = "cog_score")

```


## Intelligibility



## Hearing Threshold